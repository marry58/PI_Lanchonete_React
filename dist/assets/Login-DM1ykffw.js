import{aB as R,r as n,ad as a,aD as q,aC as l}from"./vendor-WvxInmkI.js";import{C as z,c as B,d as D,e as P,a as A,L as N,I as b,B as F,s as y}from"./index-BInAVXNB.js";import{b as H}from"./logoprincipal-CGgvGNiW.js";import"./supabase-DuVauSO6.js";import"./radix-BvlS9Eci.js";import"./react-query-D1LWqImO.js";const K=()=>{const t=R(),[d,C]=n.useState(""),[c,_]=n.useState(""),[m,i]=n.useState(!1),E=async s=>{var u,p,f,x,h;s.preventDefault(),i(!0);try{const{data:r,error:g}=await y.auth.signInWithPassword({email:d,password:c});if(g){l.error(g.message),i(!1);return}const e=r==null?void 0:r.user,j=((u=e==null?void 0:e.app_metadata)==null?void 0:u.roles)||[],v=((p=e==null?void 0:e.user_metadata)==null?void 0:p.role)||((f=e==null?void 0:e.app_metadata)==null?void 0:f.role);let o=[];if(e!=null&&e.id){const{data:w,error:I}=await y.from("user_roles").select("role").eq("user_id",e.id);!I&&w&&(o=w.map(k=>k.role))}const L=v==="master_admin"||j.includes("master_admin")||o.includes("master_admin")||((x=e==null?void 0:e.app_metadata)==null?void 0:x.role)==="master_admin",S=v==="admin"||j.includes("admin")||o.includes("admin")||((h=e==null?void 0:e.app_metadata)==null?void 0:h.role)==="admin";l.success("Login realizado com sucesso!"),t(L?"/admin-master":S?"/admin":"/inicio")}catch{l.error("Erro inesperado ao fazer login.")}i(!1)};return a.jsx("div",{className:"fixed inset-0 bg-[#ffffff8c] overflow-hidden w-full h-full flex items-center justify-center",style:{backgroundImage:`url(${H})`,backgroundSize:"cover",backgroundPosition:"top"},children:a.jsxs(z,{className:"w-full max-w-md",children:[a.jsxs(B,{className:"space-y-1",children:[a.jsx(D,{className:"text-2xl font-bold text-center",children:"Entrar"}),a.jsx(P,{className:"text-center",children:"Entre com suas credenciais para acessar sua conta"})]}),a.jsxs(A,{children:[a.jsxs("form",{onSubmit:E,className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(N,{htmlFor:"email",children:"Email"}),a.jsx(b,{id:"email",type:"email",placeholder:"seu@email.com",value:d,onChange:s=>C(s.target.value),required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(N,{htmlFor:"password",children:"Senha"}),a.jsx(b,{id:"password",type:"password",placeholder:"••••••••",value:c,onChange:s=>_(s.target.value),required:!0})]}),a.jsx(F,{type:"submit",className:"w-full",disabled:m,children:m?"Entrando...":"Entrar"})]}),a.jsxs("div",{className:"mt-4 text-center text-sm",children:["Não tem uma conta?"," ",a.jsx(q,{to:"/cadastro",className:"text-primary hover:underline font-medium",children:"Cadastre-se"})]})]})]})})};export{K as default};
