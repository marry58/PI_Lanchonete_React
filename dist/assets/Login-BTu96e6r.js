import{aB as R,r as n,ad as a,aJ as q,aC as l}from"./vendor-C4YCU9L4.js";import{B as z}from"./button-wdJszIiX.js";import{I as N}from"./input-DTTsWnCS.js";import{L as b}from"./label-CrBnGp82.js";import{C as B,c as P,d as A,e as D,a as F}from"./card-DYq_ZU2g.js";import{s as y}from"./index-DLOkv6-d.js";import{b as H}from"./logoprincipal-CGgvGNiW.js";import"./supabase-i8UOGaJf.js";import"./radix-BdbzPyf5.js";import"./react-query-CMlviXwV.js";const V=()=>{const t=R(),[d,C]=n.useState(""),[m,_]=n.useState(""),[c,o]=n.useState(!1),E=async s=>{var p,u,f,x,h;s.preventDefault(),o(!0);try{const{data:r,error:g}=await y.auth.signInWithPassword({email:d,password:m});if(g){l.error(g.message),o(!1);return}const e=r==null?void 0:r.user,j=((p=e==null?void 0:e.app_metadata)==null?void 0:p.roles)||[],v=((u=e==null?void 0:e.user_metadata)==null?void 0:u.role)||((f=e==null?void 0:e.app_metadata)==null?void 0:f.role);let i=[];if(e!=null&&e.id){const{data:w,error:I}=await y.from("user_roles").select("role").eq("user_id",e.id);!I&&w&&(i=w.map(k=>k.role))}const L=v==="master_admin"||j.includes("master_admin")||i.includes("master_admin")||((x=e==null?void 0:e.app_metadata)==null?void 0:x.role)==="master_admin",S=v==="admin"||j.includes("admin")||i.includes("admin")||((h=e==null?void 0:e.app_metadata)==null?void 0:h.role)==="admin";l.success("Login realizado com sucesso!"),t(L?"/admin-master":S?"/admin":"/inicio")}catch{l.error("Erro inesperado ao fazer login.")}o(!1)};return a.jsx("div",{className:"fixed inset-0 bg-[#ffffff8c] overflow-hidden w-full h-full flex items-center justify-center",style:{backgroundImage:`url(${H})`,backgroundSize:"cover",backgroundPosition:"top"},children:a.jsxs(B,{className:"w-full max-w-md",children:[a.jsxs(P,{className:"space-y-1",children:[a.jsx(A,{className:"text-2xl font-bold text-center",children:"Entrar"}),a.jsx(D,{className:"text-center",children:"Entre com suas credenciais para acessar sua conta"})]}),a.jsxs(F,{children:[a.jsxs("form",{onSubmit:E,className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(b,{htmlFor:"email",children:"Email"}),a.jsx(N,{id:"email",type:"email",placeholder:"seu@email.com",value:d,onChange:s=>C(s.target.value),required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(b,{htmlFor:"password",children:"Senha"}),a.jsx(N,{id:"password",type:"password",placeholder:"••••••••",value:m,onChange:s=>_(s.target.value),required:!0})]}),a.jsx(z,{type:"submit",className:"w-full",disabled:c,children:c?"Entrando...":"Entrar"})]}),a.jsxs("div",{className:"mt-4 text-center text-sm",children:["Não tem uma conta?"," ",a.jsx(q,{to:"/cadastro",className:"text-primary hover:underline font-medium",children:"Cadastre-se"})]})]})]})})};export{V as default};
